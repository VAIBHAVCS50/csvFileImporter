<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <style>
        /* Add your CSS styles here */
    </style>
</head>
<body>
    <h2>CSV Importer</h2>

    <!-- File Upload Input -->
    <input type="file" id="fileInput" accept=".csv" />

    <!-- Column Selection -->
    <h3>Select Columns:</h3>
    <div id="columnSelection"></div>

    <!-- JavaScript to handle user interactions -->
    <script>
        // Function to display column headings based on received CSV data.
        function displayColumnHeadings(csvData) {
            var columnSelection = document.getElementById("columnSelection");

            // Parse the first row of CSV data to get column headings.
            var columns = csvData.split('\n')[0].split(',');

            // Create checkboxes for each column heading.
            columns.forEach(function (column) {
                var label = document.createElement("label");
                label.innerHTML = column;

                var checkbox = document.createElement("input");
                checkbox.type = "checkbox";
                checkbox.value = column;

                columnSelection.appendChild(checkbox);
                columnSelection.appendChild(label);
                columnSelection.appendChild(document.createElement("br"));
            });
        }

        // Event listener for file input change.
        document.getElementById("fileInput").addEventListener("change", function (event) {
          console.log("Hello from JavaScript!"); // Example log message
            var fileInput = event.target;
            var selectedFile = fileInput.files[0];

            // Handle file selection and retrieve CSV data.
            var reader = new FileReader();
            reader.onload = function () {
                var csvData = reader.result;
                google.script.run.importCSVData(csvData);
            };
            reader.readAsText(selectedFile);
        });
    </script>
</body>
</html>
